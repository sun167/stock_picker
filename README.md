From an array of stocks we would like to write a program to chose the optimal timing to buy stock and to sell stock.

My idea is to calculate all the benefit for each stock bought. Then I would calculate the maximum of these calcule and put it into a hash as value and for the key it would be the indexes.